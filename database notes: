database notes:

actions:

user deposits x funds
    get user's id
    1 increase user balance by x
    find group by user's group_id
      update group's balance by x
      update group's available balance by x
    add a new transaction
      amount = amount deposited
      type = DEPOSIT
      user_id = user's id

done!!!

user can withdraw funds
    get user balance
    get group_id
      get group avail. balance
        if (user balance > withdraw amount && group avail. balance > withdraw amount)
          decrease user balance
          decrease group avail balance
          decrease group balance
            add new transaction
              amount = amount withdrawn
              type = WITHDRAW
              user_id = user's id
        else 
          say, "nope not enough funds"

done!!

user can see their balance
    get balance

done!!


user can see group balance and available balance
    find group by user's group_id
      get group balance
      get group available balance



user can take out a loan with an amount and duration ***** transactions would be really nice *****
  make new loan with 
    user_id, 
    group_id, 
    principle, 
    amount-paid(0)
  
      get user balance
      get group by group_id
      get group available balance
        if (group available balance >= loan amount)
          group available balance = group available balance - loan amount
        user balance = user balance - loan amount
        make a new transaction with 
          amount = principle
          type = LOAN
          user_id = user_id
    else
      say "nope, can't do it"

done!!!!


When user pays loan (once a month), interest gets split among other users 
  get group_id
  find user's loan
    get loan's monthly interest
    var toPrinciple = amount payed - monthly interest
    increase amount paid by toPrinciple
    increase user's balance by toPrinciple
    make a new transaction with 
          amount = principle
          type = LOAN
          user_id = user_id
    find group
      increase group's balance by interest
      increase group's available balance by amount paid
    get all members of group
      find percientage share of group for each member
        multiply percentage share by montly interest
        add to that members balance


test:
add group 1
add user 1 with group 1
add user 2 with group 1
add user 3 with group 1
add user 4 with group 1
deposit 100 for user 1
deposit 200 for user 2
deposit 300 for user 3
take 100 (1 month) loan for user 4
pay loan

results::::::::::::::
user1: 101
user2: 102
user3: 103
user4: 0
group1: 606, 606



